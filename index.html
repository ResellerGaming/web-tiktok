<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <title>TikTok Clone 2.0</title>
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover,user-scalable=no">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <style>
    :root{--pink:#fe2c55}
    *{box-sizing:border-box;margin:0;padding:0}
    html,body{height:100%;overflow:hidden}
    body{
      font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Helvetica,Arial,sans-serif;
      background:#000;color:#fff;
      display:flex;flex-direction:column;
      scroll-snap-type:y mandatory;
      scroll-behavior:smooth;
      -webkit-overflow-scrolling:touch;
    }
    /* ===== FEED ===== */
    section.feed{
      flex:none;width:100vw;height:100vh;
      scroll-snap-align:start;
      position:relative;display:flex;
      align-items:center;justify-content:center;
      background:#000;
    }
    video{width:100%;height:100%;object-fit:cover}
    /* left info */
    .info{
      position:absolute;left:14px;bottom:110px;
      max-width:65%;
    }
    .info .row{display:flex;align-items:center;gap:10px}
    .info img{
      width:44px;height:44px;border-radius:50%;
      border:2px solid var(--pink);
    }
    .info .name{font-weight:600;font-size:15px;margin-bottom:4px}
    .info .desc{font-size:14px;line-height:1.3}
    /* right icons */
    .overlay{
      position:absolute;right:14px;bottom:100px;
      display:flex;flex-direction:column;align-items:center;gap:22px;
    }
    .overlay button{
      background:rgba(34,34,34,.6);border:none;color:#fff;
      font-size:30px;width:56px;height:56px;border-radius:50%;
      cursor:pointer;display:flex;flex-direction:column;align-items:center;justify-content:center;gap:3px;
      backdrop-filter:blur(4px);
    }
    .overlay button:active{transform:scale(.85)}
    .overlay button span{font-size:11px;font-weight:600}
    .liked{color:var(--pink)!important}
    @keyframes pop{0%{transform:scale(1)}50%{transform:scale(1.4)}100%{transform:scale(1)}}
    /* progress */
    .progress{position:absolute;bottom:0;left:0;height:3px;background:rgba(255,255,255,.25);width:100%}
    .progress-bar{height:100%;background:#fff;width:0}
    /* mute */
    .mute-btn{position:absolute;bottom:14px;left:14px;background:rgba(34,34,34,.6);border:none;color:#fff;font-size:24px;width:44px;height:44px;border-radius:50%;cursor:pointer;backdrop-filter:blur(4px)}

    /* ===== PROFIL ===== */
    #profile{
      position:fixed;top:0;right:-100%;width:100%;height:100%;
      background:#111;z-index:10;transition:right .35s ease;
      overflow-y:auto;
    }
    #profile.open{right:0}
    .prof-header{
      display:flex;align-items:center;gap:15px;
      padding:20px;border-bottom:1px solid #333;
    }
    .prof-header img{width:80px;height:80px;border-radius:50%;border:3px solid var(--pink)}
    .prof-header h2{font-size:20px}
    .prof-bio{padding:20px;font-size:14px;line-height:1.4}
    .close-prof{
      position:absolute;top:20px;left:20px;
      background:none;border:none;color:#fff;font-size:28px;cursor:pointer;
    }
  </style>
</head>
<body>

  <!-- ===== FEED ===== -->
  <section class="feed" data-vid="0">
    <video data-src="/video/vidio1.mp4" muted loop playsinline></video>
    <div class="info">
      <div class="row">
        <img src="pp1.jpg" alt="">
        <div>
          <div class="name">@kucing_imut</div>
          <div class="desc">Main di taman #cat #fyp</div>
        </div>
      </div>
    </div>
    <div class="overlay">
      <button onclick="toggleLike(this)">‚ù§<span>0</span></button>
      <button>üí¨<span>0</span></button>
      <button>‚ÜóÔ∏è<span>Share</span></button>
    </div>
    <div class="progress"><div class="progress-bar"></div></div>
    <button class="mute-btn" onclick="toggleMute(this)">üîá</button>
  </section>

  <section class="feed" data-vid="1">
    <video data-src="/video/vidio2.mp4" muted loop playsinline></video>
    <div class="info">
      <div class="row">
        <img src="pp2.jpg" alt="">
        <div>
          <div class="name">@masak_hariini</div>
          <div class="desc">Resep nasi goreng 3 menit! #cook</div>
        </div>
      </div>
    </div>
    <div class="overlay">
      <button onclick="toggleLike(this)">‚ù§<span>0</span></button>
      <button>üí¨<span>0</span></button>
      <button>‚ÜóÔ∏è<span>Share</span></button>
    </div>
    <div class="progress"><div class="progress-bar"></div></div>
    <button class="mute-btn" onclick="toggleMute(this)">üîá</button>
  </section>

  <section class="feed" data-vid="2">
    <video data-src="video3.mp4" muted loop playsinline></video>
    <div class="info">
      <div class="row">
        <img src="pp3.jpg" alt="">
        <div>
          <div class="name">@petualang_travel</div>
          <div class="desc">Sunrise Bromo üåÑ #travel</div>
        </div>
      </div>
    </div>
    <div class="overlay">
      <button onclick="toggleLike(this)">‚ù§<span>0</span></button>
      <button>üí¨<span>0</span></button>
      <button>‚ÜóÔ∏è<span>Share</span></button>
    </div>
    <div class="progress"><div class="progress-bar"></div></div>
    <button class="mute-btn" onclick="toggleMute(this)">üîá</button>
  </section>

  <!-- ===== PROFIL ===== -->
  <div id="profile">
    <button class="close-prof" onclick="closeProf()">‚Üê</button>
    <div class="prof-header">
      <img id="profImg" src="pp1.jpg" alt="">
      <div>
        <h2 id="profName">@kucing_imut</h2>
        <p id="profBio">Main di taman #cat #fyp</p>
      </div>
    </div>
    <div class="prof-bio">
      <p>Followers: <b>1.2 M</b></p>
      <p>Following: <b>234</b></p>
      <p>Semua video lucu kucing saya üêæ</p>
    </div>
  </div>

<script>
  /* ===== swipe gesture ===== */
  let startX=0,currentVid=null;
  document.addEventListener('touchstart',e=>startX=e.touches[0].clientX);
  document.addEventListener('touchend',e=>{
    let endX=e.changedTouches[0].clientX,diff=startX-endX;
    if(Math.abs(diff)<50)return;
    if(diff<0){ // ke kanan ‚Üí buka profil
      const sec=document.querySelector('section.feed:nth-of-type('+(activeIndex+1)+')');
      openProf(sec);
    }
  });

  /* ===== profil ===== */
  let profOpen=false,activeIndex=0;
  function openProf(sec){
    if(profOpen)return;
    profOpen=true;
    const img=sec.querySelector('.info img').src;
    const name=sec.querySelector('.name').textContent;
    const bio=sec.querySelector('.desc').textContent;
    document.getElementById('profImg').src=img;
    document.getElementById('profName').textContent=name;
    document.getElementById('profBio').textContent=bio;
    document.getElementById('profile').classList.add('open');
    pauseAll();
  }
  function closeProf(){
    profOpen=false;
    document.getElementById('profile').classList.remove('open');
    playCurrent();
  }

  /* ===== video play/pause ===== */
  const videos=document.querySelectorAll('video');
  const feeds=document.querySelectorAll('section.feed');
  const io=new IntersectionObserver(entries=>{
    entries.forEach(en=>{
      if(en.isIntersecting){
        activeIndex=[...feeds].indexOf(en.target);
        if(!profOpen){
          en.target.querySelector('video').play();
          runProgress(en.target.querySelector('video'));
        }
      }else{
        en.target.querySelector('video').pause();
        resetProgress(en.target.querySelector('video'));
      }
    });
  },{threshold:.7});
  feeds.forEach(f=>io.observe(f));

  function pauseAll(){
    videos.forEach(v=>{v.pause();resetProgress(v);});
  }
  function playCurrent(){
    if(profOpen)return;
    const v=feeds[activeIndex].querySelector('video');
    v.play();runProgress(v);
  }

  /* ===== progress ===== */
  let barMap=new Map();
  function runProgress(video){
    const bar=video.closest('section').querySelector('.progress-bar');
    const dur=video.duration*1000,start=Date.now();
    function frame(){
      const pct=(Date.now()-start)/dur*100;
      bar.style.width=Math.min(pct,100)+'%';
      if(pct<100) barMap.set(video,requestAnimationFrame(frame));
      else { bar.style.width='0'; runProgress(video); } //loop
    }
    cancelAnimationFrame(barMap.get(video)||0);
    frame();
  }
  function resetProgress(video){
    cancelAnimationFrame(barMap.get(video)||0);
    const bar=video.closest('section').querySelector('.progress-bar');
    bar.style.width='0';
  }

  /* ===== like & mute ===== */
  function toggleLike(btn){
    btn.classList.toggle('liked');
    const n=btn.querySelector('span');
    let val=parseInt(n.textContent);
    n.textContent=btn.classList.contains('liked')?val+1:val-1;
  }
  let muted=true;
  function toggleMute(btn){
    muted=!muted;
    videos.forEach(v=>v.muted=muted);
    btn.textContent=muted?'üîá':'üîä';
  }

  /* ===== lazy load ===== */
  videos.forEach(v=>{
    if(!v.src&&v.dataset.src){v.src=v.dataset.src;v.load();}
  });
</script>
</body>
        </html>
